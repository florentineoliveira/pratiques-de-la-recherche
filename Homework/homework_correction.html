<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Correction Devoir Maison</title>
    <meta charset="utf-8" />
    <meta name="author" content="Florentine Oliveira" />
    <meta name="date" content="2025-02-18" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Correction Devoir Maison
]
.subtitle[
## Analyse du <em>gender wage gap</em> en France
]
.author[
### Florentine Oliveira
]
.date[
### 2025-02-18
]

---





layout: true

---
count:false
class: middle, center
background-color: #dd0747

# &lt;span style="color:#FAFAFA;"&gt; Partie 1: Traitement de la variable de salaire &lt;/span&gt;
&lt;span style="color:#FAFAFA;"&gt; Cette premi√®re partie vise √† examiner et pr√©parer la variable de salaire mensuel net pour l'analyse de l'√©cart de salaire H/F ult√©rieure. L'objectif est de comprendre la distribution des salaires, d'identifier et de traiter les √©ventuels probl√®mes engendr√©s par l'utilisation de donn√©es brutes.&lt;/span&gt;



---
# Question 1 (1pt)
&lt;span style="color:#dd0747"&gt;**Repr√©senter graphiquement** la distribution du salaire net mensuel des individus sous la forme d'un histogramme, en ajoutant un titre et le nom des axes. Commentez.&lt;/span&gt;

.pull-left[

``` r
ggplot(data, aes(x = wage)) +
  geom_histogram() +
  labs(title="Distribution du salaire mensuel net", 
       x = "Salaire mensuel net", 
       y = "Fr√©quence") +
  theme_bw()
```
]

.pull-right[
&lt;img src="homework_correction_files/figure-html/unnamed-chunk-2-1.svg" style="display: block; margin: auto;" /&gt;
]


---
count: false
# Question 1 (1pt)
&lt;span style="color:#dd0747"&gt;Repr√©senter graphiquement la distribution du salaire net mensuel des individus sous la forme d'un histogramme, en ajoutant un titre et le nom des axes. **Commentez**.&lt;/span&gt;

.pull-left[

``` r
ggplot(data, aes(x = wage)) +
  geom_histogram() +
  labs(title="Distribution du salaire mensuel net", 
       x = "Salaire mensuel net", 
       y = "Fr√©quence") +
  theme_bw()
```

&amp;nbsp;

- Distribution *right-skewed*

- Longue queue de distribution √† droite

- Suspicion de valeurs extr√™mes
]

.pull-right[
&lt;img src="homework_correction_files/figure-html/unnamed-chunk-4-1.svg" style="display: block; margin: auto;" /&gt;
]


---
# Question 2 (2pts)
&lt;span style="color:#dd0747"&gt;Quel peut √™tre le probl√®me induit par l'utilisation de ces donn√©es "brutes" de salaire dans un mod√®le √©conom√©trique? Comment peut-on traiter les donn√©es en cons√©quence?&lt;/span&gt;

Probl√®mes: 
- Pr√©sence d'outliers peut tirer les coefficients estim√©s vers le haut (la moyenne est sensible aux valeurs extr√™mes, pas le cas de la variance)

Soultions:
- Winsoring
- Log


---
# Question 3 (1pt)
&lt;span style="color:#dd0747"&gt; Calculez les percentiles du salaire mensuel net (*hint: utiliser la fonction `quantile()`*). Stockez la valeur du 99√®me percentile dans `q_99`. Indiquez la valeur du 99√®me percentile et interpr√©tez.&lt;/span&gt;


``` r
q_99 = quantile(data$wage, seq(0,1,0.01), na.rm = T)[100] 
q_99
```

```
##      99% 
## 7485.299
```

99% des individus de l'√©chantillon ont un salaire inf√©rieur √† 7485,299‚Ç¨, 1% ont un salaire sup√©rieur.


---
# Question 4 (1pt)
- &lt;span style="color:#dd0747"&gt; **Cr√©ez la variable `wage_winsor`** qui correspond au salaire mensuel net, `wage`, o√π les 1% des valeurs les plus √©lev√©es sont remplac√©es par la valeur du 99√®me percentile du salaire mensuel net&lt;/span&gt;
- &lt;span style="color:#dd0747"&gt;Repr√©sentez graphiquement la distribution de `wage_winsor`. Commentez.&lt;/span&gt;

.pull-left[

``` r
data$wage_winsor=ifelse(data$wage&gt;q_99,q_99,data$wage) 
```
]

---
count: false
# Question 4 (1pt)
- &lt;span style="color:#dd0747"&gt; Cr√©ez la variable `wage_winsor` qui correspond au salaire mensuel net, `wage`, o√π les 1% des valeurs les plus √©lev√©es sont remplac√©es par la valeur du 99√®me percentile du salaire mensuel net&lt;/span&gt;
- &lt;span style="color:#dd0747"&gt;**Repr√©sentez graphiquement la distribution de** `wage_winsor`. Commentez.&lt;/span&gt;

.pull-left[

``` r
data$wage_winsor=ifelse(data$wage&gt;q_99,q_99,data$wage)
  
ggplot(data, aes(x = wage_winsor)) + 
  geom_histogram() + 
  labs(title="Distribution du salaire mensuel net (Winsoris√©)" , 
       x = "Salaire mensuel net (Winsoris√©)", 
       y = "Fr√©quence") + 
  theme_bw() 
```
]

.pull-right[
&lt;img src="homework_correction_files/figure-html/unnamed-chunk-8-1.svg" style="display: block; margin: auto;" /&gt;
]


---
count: false
# Question 4 (1pt)
- &lt;span style="color:#dd0747"&gt; Cr√©ez la variable `wage_winsor` qui correspond au salaire mensuel net, `wage`, o√π les 1% des valeurs les plus √©lev√©es sont remplac√©es par la valeur du 99√®me percentile du salaire mensuel net&lt;/span&gt;
- &lt;span style="color:#dd0747"&gt;Repr√©sentez graphiquement la distribution de `wage_winsor`. **Commentez**.&lt;/span&gt;

.pull-left[

``` r
data$wage_winsor=ifelse(data$wage&gt;q_99,q_99,data$wage)
  
ggplot(data, aes(x = wage_winsor)) + 
  geom_histogram() + 
  labs(title="Distribution du salaire mensuel net (Winsoris√©)",
       x = "Salaire mensuel net (Winsoris√©)", 
       y = "Fr√©quence") + 
  theme_bw() 
```

&amp;nbsp; 

- Excess-mass √† q_99 due au winsoring

- Distribution plus "lisible"

- Encore right-skewed


]

.pull-right[
&lt;img src="homework_correction_files/figure-html/unnamed-chunk-10-1.svg" style="display: block; margin: auto;" /&gt;
]


---
# Question 5 (1pt)
- &lt;span style="color:#dd0747"&gt;**Cr√©ez la variable** `log_wage_winsor`, le logarithme de `wage_winsor`&lt;/span&gt;
- &lt;span style="color:#dd0747"&gt;Repr√©sentez graphiquement la distribution de `log_wage_winsor`. Commentez.&lt;/span&gt;

.pull-left[

``` r
data$log_wage_winsor = log(data$wage_winsor)
```
]

---
count:false
# Question 5 (1pt)
- &lt;span style="color:#dd0747"&gt;Cr√©ez la variable `log_wage_winsor`, le logarithme de `wage_winsor`&lt;/span&gt;
- &lt;span style="color:#dd0747"&gt;**Repr√©sentez graphiquement la distribution de** `log_wage_winsor`. Commentez.&lt;/span&gt;

.pull-left[

``` r
ggplot(data, aes(x = log_wage_winsor)) +
  geom_histogram() +
  labs(title="Distribution du logarithme salaire mensuel net (winsoris√©)", 
       x = "Log(Salaire mensuel net winsoris√©)", 
       y = "Fr√©quence") +
  theme_bw()
```
]


.pull-right[
&lt;img src="homework_correction_files/figure-html/unnamed-chunk-13-1.svg" style="display: block; margin: auto;" /&gt;
]


---
count:false
# Question 5 (1pt)
- &lt;span style="color:#dd0747"&gt;Cr√©ez la variable `log_wage_winsor`, le logarithme de `wage_winsor`&lt;/span&gt;
- &lt;span style="color:#dd0747"&gt;Repr√©sentez graphiquement la distribution de `log_wage_winsor`. **Commentez**.&lt;/span&gt;

.pull-left[

``` r
ggplot(data, aes(x = log_wage_winsor)) +
  geom_histogram() +
  labs(title="Distribution du logarithme salaire mensuel net (winsoris√©)", 
       x = "Log(Salaire mensuel net winsoris√©)", 
       y = "Fr√©quence") +
  theme_bw()
```

- Log permet de recentrer davantage les observations

- Apparence qui se rapproche d'une loi normale

]

.pull-right[
&lt;img src="homework_correction_files/figure-html/unnamed-chunk-15-1.svg" style="display: block; margin: auto;" /&gt;
]





---
count:false
class: middle, center
background-color: #dd0747

# &lt;span style="color:#FAFAFA;"&gt; Partie 2: Statistiques Descriptives &lt;/span&gt;
&lt;span style="color:#FAFAFA;"&gt; Cette partie a pour objectif d'explorer les donn√©es de l'enqu√™te emploi afin de mieux appr√©hender les √©carts entre femmes et hommes en termes de niveau de dipl√¥me, d'activit√©, d'occupation et de r√©mun√©ration.&lt;/span&gt;


---
count:false
class: middle, center
background-color: #f19bb5

# &lt;span style="color:#FAFAFA;"&gt; Partie A: Dipl√¥me &lt;/span&gt;

---
# Question 6 (1pt)
&lt;span style="color:#dd0747"&gt;**Repr√©senter graphiquement la distribution du niveau de dipl√¥me selon la classe d'√¢ge**. Conservez uniquement les individus √¢g√©s de 30 ans ou plus (*hint 1: utiliser la variable `AGE5`*; *hint 2: on pourra par exemple faire un barplot*). Veillez √† ce que la l√©gende indique le libell√© du niveau de dipl√¥me et non la modalit√© correspondante. Commentez.&lt;/span&gt;


``` r
library(RColorBrewer) #&lt;&lt; Palettes color-blind friendly

data %&gt;%
  filter(AGE5 != 15) %&gt;% 
  group_by(AGE5, DIP11) %&gt;% 
  summarise(count = n()) %&gt;% 
  mutate(perc = count/sum(count)) %&gt;% 
  ggplot(aes(x = AGE5, y = perc*100, fill = DIP11)) +
  geom_bar(stat="identity") +
  labs(x = "Classe d'√¢ge", y = "Pourcentage") + 
  scale_fill_brewer(palette = "Paired", name = "Dipl√¥me", 
                    labels = c("10" = "Licence (L3), Maitrise (M1),\nMaster (recherche ou professionnel),\nDEA, DESS, Doctorat", 
                               "11" = "√âcoles de niveau licence et au del√†", 
                               "30" = "DEUG", "31" = "BTS, DUT ou √©quivalent", 
                               "33" = "Param√©dical et social (niveau Bac+2)", "41" = "Baccalaur√©at G√©n√©ral", 
                               "42" = "Baccalaur√©at technologique,\nprofessionnel ou √©quivalents", 
                               "50" = "CAP, BEP ou √©quivalents","60" = "Brevet des coll√®ges", 
                               "70" = "Certificat d'√âtudes Primaires", "71" = "Sans Dipl√¥me")) +
  theme_bw()
```



---
# Question 6 (1pt)
&lt;span style="color:#dd0747"&gt;**Repr√©senter graphiquement la distribution du niveau de dipl√¥me selon la classe d'√¢ge**. Conservez uniquement les individus √¢g√©s de 30 ans ou plus (*hint 1: utiliser la variable `AGE5`*; *hint 2: on pourra par exemple faire un barplot*). Veillez √† ce que la l√©gende indique le libell√© du niveau de dipl√¥me et non la modalit√© correspondante. Commentez.&lt;/span&gt;

&amp;nbsp; 


&lt;img src="homework_correction_files/figure-html/unnamed-chunk-17-1.svg" style="display: block; margin: auto;" /&gt;

---
count:false
# Question 6 (1pt)
&lt;span style="color:#dd0747"&gt;Repr√©senter graphiquement la distribution du niveau de dipl√¥me selon la classe d'√¢ge. Conservez uniquement les individus √¢g√©s de 30 ans ou plus (*hint 1: utiliser la variable `AGE5`*; *hint 2: on pourra par exemple faire un barplot*). Veillez √† ce que la l√©gende indique le libell√© du niveau de dipl√¥me et non la modalit√© correspondante. **Commentez**.&lt;/span&gt;

Ce que l'on observe: augmentation de la dur√©e de scolarisation moyenne au fil des cohortes: les enfants sont moins nombreux √† ne pas avoir de dipl√¥me et atteignent de niveaux de dipl√¥mes plus √©lev√©s


- **Massification scolaire**: allongement de la dur√©e des √©tudes et acc√®s d‚Äôune large partie de la population √† un niveau de qualification √©lev√©, qui √©tait auparavant r√©serv√© √† une minorit√© d‚Äô√©l√®ves g√©n√©ralement issus des cat√©gories sociales les plus privil√©gi√©es
  - Allongement de la dur√©e de scolarit√© obligatoire (√† 14 ans en 1936, 16 ans en 1967)
  - Loi Berthoin de 1959 
  - Loi Haby de 1975 et mise en ≈ìuvre √† la rentr√©e 1977 qui instaure le coll√®ge unique (tous les enfants entrent en sixi√®me dans des classes indiff√©renci√©es)

- **Stratification scolaire**: multiplication des possibilit√©s de dipl√¥me, notamment avec l'apparition des fili√®res professionnelles dans les ann√©es 


---
# Question 7 (1pt):
- &lt;span style="color:#dd0747"&gt;**Cr√©ez une nouvelle variable `at_least_bac` qui vaut 1 si l'individu a un dipl√¥me au moins √©gal au Bac, 0 sinon.** &lt;/span&gt;
- &lt;span style="color:#dd0747"&gt;Comparez graphiquement la proportion d'individus ayant un dipl√¥me au moins √©gal au Bac (`at_least_bac`) entre les hommes et les femmes pour chaque tranche d'√¢ge. Repr√©sentez vos r√©sultats graphiquement. Veillez √† conserver uniquement les individus de 30 ans ou plus. Commentez. &lt;/span&gt;



``` r
data = data %&gt;% 
  mutate(at_least_bac = ifelse(DIP11 &lt; 50, 1, 0))

data %&gt;% 
  filter(AGE5 != 15) %&gt;% 
  group_by(SEXE, AGE5) %&gt;% 
  summarise(mean_by_sexe = mean(at_least_bac, na.rm = T)) %&gt;% 
  ggplot(aes(x = AGE5, y = mean_by_sexe, 
             group = SEXE, color = SEXE )) +
  geom_point() +
  geom_line() +
  labs(x = "Classe d'√¢ge", 
       y = "Part d'individus ayant un dipl√¥me au moins √©gal au Baccalaur√©at") + 
  scale_color_brewer(palette = "Dark2",
                    name = "Sexe", 
                    labels = c("1" = "Masculin", "2" = "F√©minin")) +
  theme_bw()
```


---
count: false
# Question 7 (1pt)
- &lt;span style="color:#dd0747"&gt; Cr√©ez une nouvelle variable `at_least_bac` qui vaut 1 si l'individu a un dipl√¥me au moins √©gal au Bac, 0 sinon.&lt;/span&gt;
- &lt;span style="color:#dd0747"&gt;**Comparez graphiquement la proportion d'individus ayant un dipl√¥me au moins √©gal au Bac (`at_least_bac`) entre les hommes et les femmes pour chaque tranche d'√¢ge**. Repr√©sentez vos r√©sultats graphiquement. Veillez √† conserver uniquement les individus de 30 ans ou plus. Commentez. &lt;/span&gt;

.pull-left[

``` r
data = data %&gt;% 
  mutate(at_least_bac = ifelse(DIP11 &lt; 50, 1, 0))

data %&gt;% 
  filter(AGE5 != 15) %&gt;% 
  group_by(SEXE, AGE5) %&gt;% 
  summarise(mean_by_sexe = mean(at_least_bac, na.rm = T)) %&gt;% 
  ggplot(aes(x = AGE5, y = mean_by_sexe, 
             group = SEXE, color = SEXE )) +
  geom_point() +
  geom_line() +
  labs(x = "Classe d'√¢ge", 
       y = "Part d'individus ayant un dipl√¥me au moins 
       √©gal au Baccalaur√©at") + 
  scale_color_brewer(palette = "Dark2",
                    name = "Sexe", 
                    labels = c("1" = "Masculin", "2" = "F√©minin")) +
  theme_bw()
```
]

.pull-right[
&lt;img src="homework_correction_files/figure-html/unnamed-chunk-20-1.svg" style="display: block; margin: auto;" /&gt;
]


---
count: false
# Question 7 (1pt)
- &lt;span style="color:#dd0747"&gt;Cr√©ez une nouvelle variable `at_least_bac` qui vaut 1 si l'individu a un dipl√¥me au moins √©gal au Bac, 0 sinon.&lt;/span&gt;
- &lt;span style="color:#dd0747"&gt;Comparez graphiquement la proportion d'individus ayant un dipl√¥me au moins √©gal au Bac (`at_least_bac`) entre les hommes et les femmes pour chaque tranche d'√¢ge. Repr√©sentez vos r√©sultats graphiquement. Veillez √† conserver uniquement les individus de 30 ans ou plus. **Commentez**. &lt;/span&gt;

.pull-left[

- Augmentation de la part d'individus ayant un dipl√¥me au moins √©gal au baccalaur√©at au fil des cohortes

- Rattrapage des filles 
  - Auparavant √©cart√©es de l'enseignement secondaire et sup√©rieur (autoris√©es √† passer le bac pour la premi√®re fois en 1924)
]

.pull-right[
&lt;img src="homework_correction_files/figure-html/unnamed-chunk-21-1.svg" style="display: block; margin: auto;" /&gt;
]



---
count:false
class: middle, center
background-color: #f19bb5

# &lt;span style="color:#FAFAFA;"&gt; Partie B: Participation au march√© du travail &lt;/span&gt;

---
# Question 8 (1pt)

&lt;span style="color:#dd0747"&gt;Calculez la distribution de la variable `ACTEU`, par genre, par tranche d'√¢ge, et par genre `\(\times\)` tranche d'√¢ge. Proposez une repr√©sentation graphique. Que peut-on dire de la participation au march√© du travail des femmes? &lt;/span&gt;


``` r
data %&gt;% 
  group_by(AGE5, SEXE, ACTEU) %&gt;%  # Groupement par tranche d'√¢ge, sexe, statut
  summarise(count = n()) %&gt;% 
  group_by(AGE5, SEXE) %&gt;%  # Regrouper uniquement par tranche d'√¢ge et sexe pour recalculer les pourcentages
  mutate(perc = count / sum(count)) %&gt;% 
  ggplot(aes(x = as.factor(SEXE), y = perc * 100, fill = as.factor(ACTEU))) +
  geom_bar(stat = "identity", position = "stack") +
  labs(
    x = "Sexe", 
    y = "Pourcentage", 
    fill = "Statut d'activit√©",
    title = "R√©partition du statut d'activit√© par sexe et tranche d'√¢ge"
  ) + 
  scale_fill_brewer(palette = "Paired",
                    name = "Statut d'acivit√©", 
                    labels = c("1" = "Actif occup√©", "2" = "Ch√¥mage", "3" = "Inactif")) +
  theme_bw() +
  facet_wrap(~ AGE5)
```


---
count: false
# Question 8 (1pt)

&lt;span style="color:#dd0747"&gt;Calculez la distribution de la variable `ACTEU`, par genre, par tranche d'√¢ge, et par genre `\(\times\)` tranche d'√¢ge. Proposez une repr√©sentation graphique. Que peut-on dire de la participation au march√© du travail des femmes? &lt;/span&gt;

.pull-right[
&lt;img src="homework_correction_files/figure-html/unnamed-chunk-23-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
# Question 8 (1pt)

&lt;span style="color:#dd0747"&gt;Calculez la distribution de la variable `ACTEU`, par genre, par tranche d'√¢ge, et par genre `\(\times\)` tranche d'√¢ge. Proposez une repr√©sentation graphique. Que peut-on dire de la participation au march√© du travail des femmes? &lt;/span&gt;


.pull-left[

- Les plus jeunes et plus √¢g√©s sont plus fr√©quemment inactifs que les autres tranches d'√¢ge (parce qu'en √©tudes et √† la retraite)  

- Les femmes plus inactives que les hommes, tout au long de leur vie
  - Int√©gration du march√© du travail diff√©r√©e li√©e √† une grossesse?
  - Discimination?
  - Pr√©f√©rences?

]

.pull-right[
&lt;img src="homework_correction_files/figure-html/unnamed-chunk-24-1.svg" style="display: block; margin: auto;" /&gt;
]


---
# Question 9 (2pts)
&lt;span style="color:#dd0747"&gt;Selon vous, quels sont les facteurs qui d√©terminent la participation au march√© du travail des femmes? Expliquez pourquoi.&lt;/span&gt;

- **Facteurs institutionnels**:
  - Existence, dur√©e, et montant des cong√©s parentaux, modes de garde
  - Quotas
  - Sp√©cialisations dans le dipl√¥mes

- **Facteurs √©conomiques**:
  - Besoins financiers (familles monoparentales ou pr√©caires)

- **Facteurs culturels**:
  - Statut matrimonial (&lt;span style="color:#dd0747"&gt;  **SVP** attention √† la formulation de cet argument dans vos DMs!!!!!! &lt;/span&gt;)
  - St√©r√©otypes de genre

- **Facteurs contextuels/environnementaux**:
  - Nombre d'enfants: *child penalty*


- **Discrimination**: les femmes sont moins embauch√©es parce qu'on anticipe qu'elles devront quitter temporairement le march√© du travail en cas de grossesse par exemple





---
count:false
class: middle, center
background-color: #f19bb5

# &lt;span style="color:#FAFAFA;"&gt; Partie C: R√©mun√©ration&lt;/span&gt;


---
# Question 10 (1pt)
&lt;span style="color:#dd0747"&gt;Cr√©ez la variable *quotit√©* qui vaut (*hint: utilisez les variables `TPPRED` et `TXTPPRED`*):
- 1 si l'individu travaille √† temps complet    
- 2 si l'individu travaille plus de 80%    
- 3 si l'individu travaille √† 80%    
- 4 si l'individu travaille √† temps partiel entre 50 et 80%    
- 5 si l'individu travaille √† mi-temps (50%)    
- 6 si l'individu travaille moins d'un mi-temps   &lt;/span&gt; 


``` r
data$quotit√© = case_when(data$TPPRED == 1 ~ 1,
                         data$TXTPPRED == 5 ~ 2,
                         data$TXTPPRED == 4 ~ 3,
                         data$TXTPPRED == 3 ~ 4,
                         data$TXTPPRED == 2 ~ 5,
                         data$TXTPPRED == 1 ~ 6)
```

---
# Question 11 (1pt)
&lt;span style="color:#dd0747"&gt;√âtudiez la distribution de la quotit√© de temps de travail (`quotit√©`) des individus en fonction de la pr√©sence d'au moins un enfant dans le m√©nage (`ENFRED`), **sur l'√©chantillon global**, puis s√©par√©ment sur celui des hommes et des femmes. Commentez.&lt;/span&gt;



``` r
#ENFRED: individu avec au moins 1 enfant dans le m√©nage:; 1 = Oui, 2 = Non
round(prop.table(table(data$quotit√©, data$ENFRED), margin = 2), 2)
#       1    2
#  1 0.80 0.81
#  2 0.02 0.02
#  3 0.05 0.03
#  4 0.06 0.06
#  5 0.03 0.03
#  6 0.03 0.06
```


---
count: false
# Question 11 (1pt)
&lt;span style="color:#dd0747"&gt;√âtudiez la distribution de la quotit√© de temps de travail (`quotit√©`) des individus en fonction de la pr√©sence d'au moins un enfant dans le m√©nage (`ENFRED`), sur l'√©chantillon global, puis **s√©par√©ment sur celui des hommes et des femmes**. Commentez.&lt;/span&gt;



``` r
#ENFRED: individu avec au moins 1 enfant dans le m√©nage:; 1 = Oui, 2 = Non
round(prop.table(table(data$quotit√©[data$SEXE == 1], data$ENFRED[data$SEXE == 1]), margin = 2), 2)
#       1    2
#  1 0.94 0.88
#  2 0.01 0.01
#  3 0.01 0.01
#  4 0.02 0.04
#  5 0.01 0.02
#  6 0.01 0.04

round(prop.table(table(data$quotit√©[data$SEXE == 2], data$ENFRED[data$SEXE == 2]), margin = 2), 2)
#       1    2
#  1 0.67 0.72
#  2 0.04 0.02
#  3 0.10 0.04
#  4 0.09 0.08
#  5 0.05 0.04
#  6 0.06 0.09
```


---
count: false
# Question 11 (1pt)
&lt;span style="color:#dd0747"&gt;√âtudiez la distribution de la quotit√© de temps de travail (`quotit√©`) des individus en fonction de la pr√©sence d'au moins un enfant dans le m√©nage (`ENFRED`), sur l'√©chantillon global, puis s√©par√©ment sur celui des hommes et des femmes. **Commentez**.&lt;/span&gt;

- Sur l'√©chantillon global, participation au march√© du travail √† temps plein ne semble pas √™tre affect√©e par la pr√©sence d'un enfant ou non dans le m√©nage
- Lorsqu'on regarde en d√©tail comment cela affecte la quotit√© de temps de travail selon le genre:
  - Les hommes ayant au moins 1 enfant dans le m√©nage sont plus fr√©quemment √† temps plein et √† une quotit√© de temps partiel √©lev√©e que ceux sans enfant
  - Au contraite, les femmes ayant au moins un enfant dans le m√©nage sont plus fr√©quemment √† temps partiel


---
# Question 12 (1pt)
&lt;span style="color:#dd0747"&gt;√âtudiez la r√©partition par genre dans chacune des CSP (variable `CSP`) en ne conservant que les individus √¢g√©s d'au moins 30 ans et dont la CSP est bien d√©finie et non nulle. Commentez. &lt;/span&gt;

.pull-left[

``` r
data %&gt;% 
  filter(AGE5 != 15, !(CSP %in% c("00", NA))) %&gt;% 
  group_by(CSP) %&gt;% 
  summarise(n = n(), 
            share_women = sum(SEXE == 2)/n) %&gt;% 
  ungroup() %&gt;% 
  arrange(share_women) %&gt;% 
  ggplot(aes(x = CSP, y = share_women* 100)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(
    title = "Proportion de femmes par CSP",
    x = "Cat√©gories Socioprofessionnelles (CSP)",
    y = "Part de femmes (%)"
  ) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

- CSP tr√®s masculines et d'autres tr√®s f√©minines

]

.pull-right[
&lt;img src="homework_correction_files/figure-html/unnamed-chunk-29-1.svg" style="display: block; margin: auto;" /&gt;
]


---
# Question 13 (1pt)
&lt;span style="color:#dd0747"&gt;**Cr√©ez un dataframe** qui comprend, pour chaque CSP, la moyenne du log du salaire mensuel net winsoris√© et la proportion de femmes en vous restreignant aux individus de 30 ans ou plus et aux CSP connues et non nulles. Qu'observez-vous?&lt;/span&gt;

.pull-left[

``` r
data_cor = data %&gt;%
  filter(AGE5 != 15, !(CSP %in% c("00", NA))) %&gt;%
  group_by(CSP) %&gt;% 
  summarise(mean_wage = mean(wage_winsor, na.rm = T),
            share_women = sum(SEXE == 2)/n()) %&gt;% 
  ungroup() %&gt;% 
  filter(!is.na(mean_wage))

head(data_cor)
```

```
## # A tibble: 6 √ó 3
##   CSP   mean_wage share_women
##   &lt;fct&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 21        2333.       0.229
## 2 22        2077.       0.397
## 3 23        4293.       0.207
## 4 31        2896.       0.449
## 5 33        3803.       0.471
## 6 34        3854.       0.536
```
]

---
count: false
# Question 13 (1pt)
&lt;span style="color:#dd0747"&gt;Cr√©ez un dataframe qui comprend, pour chaque CSP, la moyenne du log du salaire mensuel net winsoris√© et la proportion de femmes en vous restreignant aux individus de 30 ans ou plus et aux CSP connues et non nulles. **Qu'observez-vous?**&lt;/span&gt;

.pull-left[

``` r
data_cor = data %&gt;%
  filter(AGE5 != 15, !(CSP %in% c("00", NA))) %&gt;%
  group_by(CSP) %&gt;% 
  summarise(mean_wage = mean(wage_winsor, na.rm = T),
            share_women = sum(SEXE == 2)/n()) %&gt;% 
  ungroup() %&gt;% 
  filter(!is.na(mean_wage))

head(data_cor)
```

```
## # A tibble: 6 √ó 3
##   CSP   mean_wage share_women
##   &lt;fct&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 21        2333.       0.229
## 2 22        2077.       0.397
## 3 23        4293.       0.207
## 4 31        2896.       0.449
## 5 33        3803.       0.471
## 6 34        3854.       0.536
```
]

.pull-right[
- Femme sous-repr√©sent√©es dans les CSP o√π le salaire moyen est le plus √©lev√©
  - Ing√©nieur (gender-gap dans les STEM)
  - Chef d'entreprise
  
- et sur-repr√©sent√©es dans les CSP o√π le salaire moyen est le plus faible 
  - m√©tiers du *care*

]

---
count:false
class: middle, center
background-color: #dd0747

# &lt;span style="color:#FAFAFA;"&gt; Partie 3: Analyse √âconom√©trique &lt;/span&gt;
&lt;span style="color:#FAFAFA;"&gt; Cette analyse √©conom√©trique explore les d√©terminants du salaire horaire et √©value l'effet de leur prise en compte sur l'√©cart salarial moyen entre femmes et hommes.&lt;/span&gt;

---
# Question 14 (0.5pt)
- &lt;span style="color:#dd0747"&gt; **Cr√©ez la variable `femme`** qui vaut 1 si l'individu est une femme, 0 sinon. Assurez-vous que la variable soit de type `factor` &lt;/span&gt;
- &lt;span style="color:#dd0747"&gt; Cr√©ez la variable `CSP_r` qui est √©gale au premier chiffre de la CSP (chiffre des dizaines) si la CSP est diff√©rente de 23 (Chefs d'entreprises de 10 salari√©s ou plus); si la CSP est √©gale √† 23, alors attribuer √† `CSP_r` la valeur 3 (i.e. on consid√®re que leur situation se rapproche davantage de celle des Cadres et Professions interm√©diaires que de celle des Artisans et Commer√ßants). &lt;/span&gt;



``` r
data = data %&gt;% 
* mutate(femme = factor(ifelse(data$SEXE == 2, 1, 0)),
         CSP_r = ifelse(data$CSP == 23, 3, substr(data$CSP, 1, 1)))
```


---
count:false
# Question 14 (0.5pt)
- &lt;span style="color:#dd0747"&gt; Cr√©ez la variable `femme` qui vaut 1 si l'individu est une femme, 0 sinon. Assurez-vous que la variable soit de type `factor` &lt;/span&gt;
- &lt;span style="color:#dd0747"&gt; **Cr√©ez la variable `CSP_r`** qui est √©gale au premier chiffre de la CSP (chiffre des dizaines) si la CSP est diff√©rente de 23 (Chefs d'entreprises de 10 salari√©s ou plus); si la CSP est √©gale √† 23, alors attribuer √† `CSP_r` la valeur 3 (i.e. on consid√®re que leur situation se rapproche davantage de celle des Cadres et Professions interm√©diaires que de celle des Artisans et Commer√ßants). &lt;/span&gt;



``` r
data = data %&gt;% 
  mutate(femme = factor(ifelse(data$SEXE == 2, 1, 0)),
*        CSP_r = ifelse(data$CSP == 23, 3, substr(data$CSP, 1, 1)))
```


---
# Question 15 (0.5pt)
&lt;span style="color:#dd0747"&gt;Cr√©ez le dataframe `data_reg`&lt;/span&gt; √† partir de `data` qui comprend uniquement les observations:       
- des individus √¢g√©s de 30 ans ou plus       
- qui sont en CDD ou CDI       
- qui appartiennent √† une `CSP_r` diff√©rente de 0        
- qui appartiennent √† une `CSP` comprend au moins 30 individus       
- des individus qui travaillent au moins une heure par semaine        

.pull-right[

``` r
data_reg = data %&gt;% 
  filter(AGE5 != 15,
*        CONTRA %in% c(1,2),
         ! (CSP_r %in% c(0,1)),
         HHCE &gt; 0) %&gt;% 
  group_by(CSP) %&gt;% 
  mutate(n = n()) %&gt;% 
  ungroup() %&gt;% 
  filter(n&gt;30)
```

]

.pull-right[

``` r
data_reg = data %&gt;% 
  filter(AGE5 != 15,
*        STATUTR %in% c(4,5),
         ! (CSP_r %in% c(0,1)),
         HHCE &gt; 0) %&gt;% 
  group_by(CSP) %&gt;% 
  mutate(n = n()) %&gt;% 
  ungroup() %&gt;% 
  filter(n&gt;30)
```
]

---
# Question 16 (1pt)
&lt;span style="color:#dd0747"&gt;Calculez l'√©cart du salaire moyen entre hommes et femmes (en niveau et en pourcentage, en utilisant le salaire mensuel net winsoris√©).&lt;/span&gt;


``` r
(mean(data_reg$wage_winsor[data_reg$femme == 1], na.rm = T) - mean(data_reg$wage_winsor[data_reg$femme == 0], na.rm = T))
```

```
## [1] -581.7032
```

``` r
(mean(data_reg$wage_winsor[data_reg$femme == 1], na.rm = T)-mean(data_reg$wage_winsor[data_reg$femme == 0], na.rm = T))/mean(data_reg$wage_winsor[data_reg$femme == 0], na.rm = T)
```

```
## [1] -0.2311041
```

- Les femmes gagnent en moyenne 581,7‚Ç¨ euros de moins que les hommes.
- Le salaire moyen des femmes est inf√©rieur de 23,1% √† celui des hommes.

---
# Question 17 (2pt)
&lt;span style="color:#dd0747"&gt; **Estimez le mod√®le** `\(log(\text{Salaire mensuel Winsoris√©}) = \alpha + \beta \text{Femme} + \varepsilon\)`. Que repr√©sentent `\(\alpha\)` et `\(\beta\)`? Peut-on dire que `\(\beta\)` est causal? &lt;/span&gt;

``` r
reg = lm(log_wage_winsor ~ femme, data = data_reg)
#summary(reg)
coeftest(reg) # utiliser cette commande pour avoir des std errors robustes √† l'h√©t√©rosc√©dasticit√©
```

```
## 
## t test of coefficients:
## 
##               Estimate Std. Error  t value  Pr(&gt;|t|)    
## (Intercept)  7.6970322  0.0043897 1753.413 &lt; 2.2e-16 ***
## femme1      -0.2910540  0.0062270  -46.741 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
```

---
count:false
# Question 17 (2pt)
&lt;span style="color:#dd0747"&gt;Estimez le mod√®le `\(log(\text{Salaire mensuel Winsoris√©}) = \alpha + \beta \text{Femme} + \varepsilon\)`. **Que repr√©sentent `\(\alpha\)` et `\(\beta\)`?** Peut-on dire que `\(\beta\)` est causal? &lt;/span&gt;

Ici, c'est un mod√®le **Log-level**, i.e. l'outcome est exprim√© en log et la variable explicative en niveau. 

- `\(\alpha\)`: moyene du log du salaire des hommes

- `\(\beta\)`: 
  - &lt;span style="color:#dd0747"&gt; **Interpr√©tation rigoureuse**: en moyenne, √™tre une femme est associ√© √† une diminution de salaire de `\((e^{\beta} - 1)*100 = - 25.25247\)` % &lt;/span&gt;
  - **Approximation** possible üö® lorsque `\(\beta\)` est **petit** üö®: en moyenne, √™tre une femme est associ√© √† une diminution de salaire de `\(\beta * 100 = - 29.10540\)`%


---
count:false
# Question 17 (2pt)
&lt;span style="color:#dd0747"&gt;Estimez le mod√®le `\(log(\text{Salaire mensuel Winsoris√©}) = \alpha + \beta \text{Femme} + \varepsilon\)`. Que repr√©sentent `\(\alpha\)` et `\(\beta\)`? **Peut-on dire que `\(\beta\)` est causal?** &lt;/span&gt;

Ici, c'est un mod√®le **Log-level**, i.e. l'outcome est exprim√© en log et la variable explicative en niveau. 

- `\(\alpha\)`: moyene du log du salaire des hommes

- `\(\beta\)`: 
  - &lt;span style="color:#dd0747"&gt; **Interpr√©tation rigoureuse**: en moyenne, √™tre une femme est associ√© √† une diminution de salaire de `\((e^{\beta} - 1)*100 = - 25.25247\)` % &lt;/span&gt;
  - **Approximation** possible üö® lorsque `\(\beta\)` est **petit** üö®: en moyenne, √™tre une femme est associ√© √† une diminution de salaire de `\(\beta * 100 = - 29.10540\)`%

On ne peut pas dire que `\(\beta\)` est causal: comme on l'a vu au fil des pr√©c√©dentes questions, le dipl√¥me, la CSP, le nombre d'enfants sont **corr√™l√©s avec le fait d'√™tre une femme** et **influencent √©galement le salaire**.



---
# Question 18 (1.5pt)
- &lt;span style="color:#dd0747"&gt;**Cr√©ez la variable salaire (winsoris√©) **horaire** et son log**, que vous nommerez `hwage_winsor` et `log_hwage_winsor` (*hint: utiliser la variable `HHCE`, le nombre d'heures travaill√©es en moyenne **par semaine** dans l'emploi principal*) &lt;/span&gt;
- &lt;span style="color:#dd0747"&gt;Quel est maintenant l'√©cart de salaire moyen entre femmes et hommes? Comment se compare-t-il √† l'√©cart de salaire calcul√© en question 16 et comment expliquez-vous cette diff√©rence? &lt;/span&gt;


``` r
data_reg = data_reg %&gt;% 
  mutate(hwage_winsor = wage_winsor/(data_reg$HHCE*151.67/35),
         log_hwage_winsor = log(hwage_winsor))

(mean(data_reg$hwage_winsor[data_reg$femme == 1], na.rm = T) - mean(data_reg$hwage_winsor[data_reg$femme == 0], na.rm = T))/mean(data_reg$hwage_winsor[data_reg$femme == 0], na.rm = T)
```

```
## [1] -0.1309692
```


---
count:false
# Question 18 (1.5pt)
- &lt;span style="color:#dd0747"&gt;Cr√©ez la variable salaire (winsoris√©) **horaire** et son log, que vous nommerez `hwage_winsor` et `log_hwage_winsor` (*hint: utiliser la variable `HHCE`, le nombre d'heures travaill√©es en moyenne **par semaine** dans l'emploi principal*)&lt;/span&gt;
- &lt;span style="color:#dd0747"&gt; **Quel est maintenant l'√©cart de salaire moyen entre femmes et hommes**? **Comment se compare-t-il √† l'√©cart de salaire calcul√© en question 16 et comment expliquez-vous cette diff√©rence?** &lt;/span&gt;


``` r
data_reg = data_reg %&gt;% 
  mutate(hwage_winsor = wage_winsor/(data_reg$HHCE*151.67/35),
         log_hwage_winsor = log(hwage_winsor))

(mean(data_reg$hwage_winsor[data_reg$femme == 1], na.rm = T) - mean(data_reg$hwage_winsor[data_reg$femme == 0], na.rm = T))/mean(data_reg$hwage_winsor[data_reg$femme == 0], na.rm = T)
```

```
## [1] -0.1309692
```

- L'√©cart de salaire moyen entre hommes et femmes, une fois pris en compte la quotit√© de temps de travail, est de 13,09692%, soit presque la moiti√© du gap calcul√© √† la question 16
- Sugg√®re qu'une partie on n√©gligeable du gap de salaire H/F est d√ª √† des diff√©rences dans le temps travaill√© (= *effet de composition*)



---
# Question 19 (2pt)
&lt;span style="color:#dd0747"&gt;Proposez un mod√®le de r√©gression lin√©aire qui permet d'att√©nuer les probl√®mes d'identification soulev√©s √† la question 17. Commentez les r√©sultats. En particulier, comment varie `\(\beta\)`? Qu'est-ce que cela indique de l'√©cart de salaire moyen entre hommes et femmes calcul√© en question 17? &lt;/span&gt;

Par exemple, `\(log(\text{Salaire horraire Winsoris√©}) = \alpha + \beta \text{Femme} + \gamma \;\mathbb{1}(\ge {Bac})+ \delta \text{CSP}  +\varepsilon\)`

Quelque soit le mod√®le que vous avez estim√©, l'inclusion de ces variables de contr√¥le entra√Æne une diminution de `\(\beta\)` (en valeur absolue).

---
# Question 20 (2pt) 
&lt;span style="color:#dd0747"&gt; Selon vous, peut-on dire que `\(\beta\)` estim√© √† la question 19 est causal? Expliquez. &lt;/span&gt;


Effectivement, √† force d'inclure des variables de contr√¥le, on se rapproche d'un estimateur de `\(\beta\)` qui capture uniquement l'effet du genre sur le salaire.

&lt;span style="color:#dd0747"&gt;MAIS, il existe toujours des **facteurs inobserv√©s et inobservables**, tels que:&lt;/span&gt; 

- la motivation
- la discrimination sur le march√© du travail
- salaire de r√©serve
- confiance en soi/capacit√© de n√©gociation (*gender ask gap*)

&lt;span style="color:#dd0747"&gt;qui nous emp√™chent de dire que `\(\beta\)` est causal. &lt;/span&gt; 



---
count:false
class: middle, center
background-color: #dd0747

# &lt;span style="color:#FAFAFA;"&gt; Partie 4: D√©composition d'Oaxaca-Blinder &lt;/span&gt;

---
# D√©composition d'Oaxaca-Blinder
La m√©thode de d√©composition d'Oaxaca-Blinder permet de mesurer la part de l'√©cart entre le salaire moyen des femmes et celui des hommes qui est due √† des diff√©rences dans les caract√©ristiques moyennes et celle due √† des diff√©rences d'effets de ces caract√©ristiques sur le salaire moyen (dit autrement √† des diff√©rences dans les coefficients de r√©gression). 
On consid√®re deux groupes, celui des femmes *F* et celui des hommes *H*. L'√©cart de salaire moyen entre les deux groupes s'√©crit:

`\begin{equation}
\Delta \overline{Y} = \overline{Y}_H - \overline{Y}_F
\end{equation}`

o√π `\(\overline{Y}_i\)`, `\(i \in \{H,F\}\)` est le salaire horaire moyen du groupe `\(i\)`.


### D√©composition du *gender wage gap* en deux parties

Cette d√©composition permet d'√©crire l'√©cart moyen de salaire H/F comme la somme d'une partie expliqu√©e par des diff√©rences de caract√©ristiques et d'une partie inexpliqu√©e.

`\begin{equation}
\Delta \overline{Y} = \underbrace{\left( \overline{X}_H' - \overline{X}_F' \right)' \hat{\beta}_H}_{\text{Expliqu√©e}} + \underbrace{\overline{X}_F' \left( \hat{\beta}_F - \hat{\beta}_H \right) }_{\text{Inexpliqu√©e}} 
\end{equation}`

---
# Question 21 (1pt)
&lt;span style="color:#dd0747"&gt; D√©crivez ce que mesure la seconde partie de l'√©quation (2)? Pourquoi parle t-on de composante inexpliqu√©e de l'√©cart de salaire hommes/femmes?&lt;/span&gt;


La seconde partie de l'√©quation mesure, √† caract√©ristiques moyennes des femmes donn√©es, l'√©cart de rendement de ces caract√©ristiques entre femmes et hommes. Dit autrement, cet indicateur mesure la part de l'√©cart du salaire moyen entre hommes et femmes qui est d√ª √† des diff√©rences dans les rendements des caract√©ristiques et non √† des diff√©rences de caract√©ristiques. 

On parle de composante non expliqu√©e car elle ne rel√®ve pas d'un *effet de composition* mais s'apparente plut√¥t √† de la discrimination.


---
# Question 22 (2pts)
&lt;span style="color:#dd0747"&gt; Installez et chargez le package `oaxaca`. Utilisez la fonction `oaxaca` pour r√©aliser une d√©composition d'Oaxaca-Blinder en deux parties. Que peut-on conclure sur les √©carts de r√©mun√©ration salariale entre femmes et hommes? Vous pourrez vous r√©f√©rer √† la documentation du package disponible en ligne et vous aider d'un graphique pour interpr√©ter les r√©sultats.&lt;/span&gt;


``` r
library(oaxaca)
oaxaca = oaxaca(log_hwage_winsor ~ as.factor(CSP_r) + as.factor(at_least_bac)  + as.factor(ANCENTR4)  | femme , data = data_reg)

# oaxaca$y # y.diff= 0.1768753

oaxaca$twofold$overall[,c(1,2,4)] # coefficients de r√©f√©rence estim√©s chez les hommes
```

```
##      group.weight coef(explained) coef(unexplained)
## [1,]    0.0000000      0.03842147        0.10548794
## [2,]    1.0000000      0.04887939        0.09503002
## [3,]    0.5000000      0.04365043        0.10025898
## [4,]    0.5030341      0.04368217        0.10022725
## [5,]   -1.0000000      0.06429823        0.07961118
## [6,]   -2.0000000      0.04782188        0.09608753
```

``` r
# 0.077419846: diff√©rence de salaire moyen de h et femmes si les caract√©ristiques des femmes √©taient valoris√©es comme celles des hommes
# 0.099455490: diff√©rence entre le salaire que toucheraient les femmes si leurs caract√©ristiques √©taient valoris√©es comme celles des hommes, et le salaire moyen effectivement observ√© chez les femmes
```


---
# Question 22 (2pts)

.pull-left[
*Explained*: contribution de chaque variable √† l'√©cart expliqu√©

*Unexplained*: contribution de chaque variable √† l'√©cart inexpliqu√©

Signe du coefficient:
- les coefficients positifs sont ceux qui contribuent √† augmenter l'√©cart
 les coefficients n√©gatifs sont ceux qui contribuent √† diminuer l'√©cart 
 
Magnitude du coefficient: le rapporter √† l'√©cart de salaire moyen expliqu√© et inexpliqu√© calcul√© plus haut
]

.pull-right[

``` r
plot(oaxaca, decomposition = "twofold", group.weight = -1)
```

&lt;img src="homework_correction_files/figure-html/unnamed-chunk-41-1.svg" style="display: block; margin: auto;" /&gt;
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
